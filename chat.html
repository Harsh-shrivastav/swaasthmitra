<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat - Swaasthmitra</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header" id="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon"><img id="logo-icon" src="logo.png" alt=""></div>
                    <span class="logo-text">Swaasthmitra</span>
                </div>

                <nav class="nav-desktop" id="navDesktop">
                    <a href="index.html" class="nav-link">Home</a>
                    <a href="#" class="nav-link">Features</a>
                    <a href="#" class="nav-link">About</a>
                    <button class="btn-primary">Get Started</button>
                </nav>

                <button class="menu-button" id="menuButton" aria-label="Menu">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
            </div>

            <nav class="nav-mobile" id="navMobile">
                <a href="index.html" class="nav-link-mobile">Home</a>
                <a href="#" class="nav-link-mobile">Features</a>
                <a href="#" class="nav-link-mobile">About</a>
                <button class="btn-primary btn-full">Get Started</button>
            </nav>
        </div>
    </header>

    <!-- Chat Section -->
    <section class="chat-page">
        <div class="container">
            <div class="chat-page-content">
                <div class="chat-header">
                    <h1 class="chat-title">Chat</h1>
                    <p class="chat-subtitle">Talk to your AI health assistant</p>
                </div>

                <div class="chat-container">
                    <!-- Status Bar -->
                    <div class="chat-status-bar">
                        <div class="status-indicator online">
                            <div class="status-dot"></div>
                            <span>Online</span>
                        </div>
                        <div class="connection-info">
                            <svg class="status-icon" id="connectionIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M5 12.55a11 11 0 0 1 14.08 0"></path>
                                <path d="M1.42 9a16 16 0 0 1 21.16 0"></path>
                                <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
                                <line x1="12" y1="20" x2="12.01" y2="20"></line>
                            </svg>
                        </div>
                    </div>

                    <!-- Chat Messages Area -->
                    <div class="chat-messages-area">
                        <div class="chat-messages" id="chatMessages">
                            <div class="message message-bot">
                                <div class="message-avatar">
                                    <div class="avatar-icon">ü©∫</div>
                                </div>
                                <div class="message-bubble">
                                    <div class="message-header">
                                        <span class="sender-name">Dr. Swaasthya</span>
                                        <span class="message-time">Just now</span>
                                    </div>
                                    <div class="message-text">
                                        <div class="greeting-message">
                                            <strong>Namaste! I'm Dr. Swaasthya, your AI medical assistant.</strong>
                                        </div>
                                        <div class="consultation-intro">
                                            I'm here to help assess your symptoms and provide medical guidance. Let's start with some basic information:
                                        </div>
                                        <div class="quick-questions">
                                            <button class="medical-question-btn" onclick="startMedicalConsultation()">ü©∫ Start Medical Assessment</button>
                                            <button class="medical-question-btn" onclick="startEmergencyMode()">üö® This is an Emergency</button>
                                        </div>
                                        <div class="medical-disclaimer">
                                            <small><em>‚ö†Ô∏è This is not a substitute for professional medical advice. Always consult healthcare providers for serious conditions.</em></small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Typing Indicator -->
                        <div class="typing-indicator" id="typingIndicator" style="display: none;">
                            <div class="message message-bot">
                                <div class="message-avatar">
                                    <div class="avatar-icon">ü©∫</div>
                                </div>
                                <div class="typing-bubble">
                                    <div class="typing-dots">
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                    </div>
                                    <span class="typing-text">Dr. Swaasthya is analyzing...</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Language Toggle -->
                    <div class="language-section">
                        <label class="language-label">Language:</label>
                        <div class="language-toggle">
                            <button class="lang-button active" data-lang="en">English</button>
                            <button class="lang-button" data-lang="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
                        </div>
                    </div>

                    <!-- Symptom Suggestions -->
                    <div class="symptom-suggestions" id="symptomSuggestions" style="display: none;">
                        <div class="suggestions-header">Common symptoms:</div>
                        <div class="suggestions-list" id="suggestionsList"></div>
                    </div>

                    <!-- Chat Input Area -->
                    <div class="chat-input-container">
                        <div class="chat-input-area">
                            <div class="input-wrapper">
                                <input type="text" id="chatInput" class="chat-input" placeholder="Type your symptoms (e.g., 'fever and headache for 2 days')..." autocomplete="off">
                                <div class="input-actions">
                                    <button class="icon-button" id="micButton" title="Voice Input">
                                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                                            <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                                            <line x1="12" y1="19" x2="12" y2="23"></line>
                                            <line x1="8" y1="23" x2="16" y2="23"></line>
                                        </svg>
                                    </button>
                                    
                                    <button class="icon-button btn-send" id="sendButton" title="Send Message">
                                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <line x1="22" y1="2" x2="11" y2="13"></line>
                                            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Medical Quick Actions -->
                        <div class="medical-quick-actions">
                            <div class="action-group">
                                <div class="action-group-title">Common Conditions</div>
                                <button class="medical-action-btn" data-message="fever with body ache for 3 days">ü§í Fever & Body Ache</button>
                                <button class="medical-action-btn" data-message="severe headache with nausea">ü§ï Severe Headache</button>
                                <button class="medical-action-btn" data-message="stomach pain and vomiting">ü§¢ Stomach Issues</button>
                                <button class="medical-action-btn" data-message="cough and cold symptoms">ü§ß Cold & Cough</button>
                            </div>
                            <div class="action-group">
                                <div class="action-group-title">Emergency Situations</div>
                                <button class="medical-action-btn emergency" data-message="chest pain and difficulty breathing">‚ö†Ô∏è Chest Pain</button>
                                <button class="medical-action-btn emergency" data-message="severe injury with bleeding">ü©∏ Severe Injury</button>
                                <button class="medical-action-btn emergency" data-message="pregnancy emergency complications">ü§± Pregnancy Emergency</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chat Features Info -->
                <div class="chat-features">
                    <h3 class="features-title">Available Features</h3>
                    <div class="features-grid">
                        <div class="feature-item">
                            <div class="feature-icon">ü©∫</div>
                            <div class="feature-text">
                                <h4>Symptom Analysis</h4>
                                <p>Get instant analysis of your symptoms</p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">üö®</div>
                            <div class="feature-text">
                                <h4>Emergency Detection</h4>
                                <p>Automatic identification of critical conditions</p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">üì±</div>
                            <div class="feature-text">
                                <h4>Works Offline</h4>
                                <p>Get help even without internet connection</p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">üåê</div>
                            <div class="feature-text">
                                <h4>Bilingual Support</h4>
                                <p>Available in Hindi and English</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Load configuration first -->
    <script src="config.js"></script>
    <!-- Load medical chat system -->
    <script src="medical-chat.js"></script>
    
    <script>
        // Emergency Mode Function
        function startEmergencyMode() {
            const emergencyHTML = `
                <div class="emergency-alert">
                    <div class="emergency-header">
                        <h2>üö® EMERGENCY PROTOCOL ACTIVATED</h2>
                    </div>
                    <div class="emergency-content">
                        <div class="immediate-actions">
                            <h3>IMMEDIATE ACTIONS:</h3>
                            <ol>
                                <li><strong>CALL 108</strong> (Emergency Services) immediately</li>
                                <li>Stay calm and provide your location</li>
                                <li>If possible, have someone stay with you</li>
                                <li>Do not leave the patient alone</li>
                            </ol>
                        </div>
                        <div class="emergency-buttons">
                            <a href="tel:108" class="emergency-call-btn">üìû CALL 108 NOW</a>
                        </div>
                        <div class="emergency-disclaimer">
                            <strong>This is not a substitute for emergency medical services. Always call professional emergency services first.</strong>
                        </div>
                    </div>
                </div>
            `;
            
            medicalChat.addMessageToChat({
                id: Date.now().toString(),
                role: 'assistant',
                content: emergencyHTML,
                timestamp: new Date(),
                isEmergency: true
            });
        }

        // Initialize medical consultation system
        document.addEventListener('DOMContentLoaded', function() {
            // Character count for text areas
            document.addEventListener('input', function(e) {
                if (e.target.classList.contains('medical-textarea')) {
                    const charCount = document.getElementById('charCount_' + e.target.id.split('_')[1]);
                    if (charCount) {
                        charCount.textContent = `${e.target.value.length}/1000`;
                    }
                }
            });

            // Medical action buttons functionality
            const medicalActionBtns = document.querySelectorAll('.medical-action-btn');
            medicalActionBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const message = this.getAttribute('data-message');
                    if (message) {
                        if (this.classList.contains('emergency')) {
                            startEmergencyMode();
                        } else {
                            // Start consultation with pre-filled complaint
                            medicalChat.patientData.answers['primary_concern'] = message;
                            medicalChat.startConsultation();
                        }
                    }
                });
            });

            // Handle regular chat input (fallback)
            const chatInput = document.getElementById('chatInput');
            const sendButton = document.getElementById('sendButton');
            
            if (sendButton && chatInput) {
                sendButton.addEventListener('click', function() {
                    const message = chatInput.value.trim();
                    if (message) {
                        if (!medicalChat.isInProgress) {
                            // Start consultation with user's message as chief complaint
                            medicalChat.patientData.answers['primary_concern'] = message;
                            medicalChat.startConsultation();
                        } else {
                            // Add as general message if consultation in progress
                            medicalChat.addMessageToChat({
                                id: Date.now().toString(),
                                role: 'user',
                                content: message,
                                timestamp: new Date()
                            });
                        }
                        chatInput.value = '';
                    }
                });
            }

            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendButton.click();
                    }
                });
            }
        });

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInFromLeft {
                0% {
                    opacity: 0;
                    transform: translateX(-20px);
                }
                100% {
                    opacity: 1;
                    transform: translateX(0);
                }
            }
            
            .start-consultation-btn {
                background: linear-gradient(135deg, var(--emerald-600), var(--secondary));
                color: white;
                border: none;
                padding: 1rem 2rem;
                border-radius: var(--radius-lg);
                font-size: 1rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s;
                margin: 1rem 0;
                width: 100%;
            }
            
            .start-consultation-btn:hover {
                transform: translateY(-2px);
                box-shadow: var(--shadow-lg);
            }
            
            .config-error {
                background-color: rgba(239, 68, 68, 0.1);
                border: 2px solid #dc2626;
                border-radius: var(--radius-lg);
                padding: 2rem;
                text-align: center;
                color: #dc2626;
            }
            
            .config-instructions {
                background-color: white;
                border-radius: var(--radius-md);
                padding: 1rem;
                margin-top: 1rem;
                text-align: left;
            }
            
            .config-instructions code {
                background-color: var(--muted);
                padding: 0.25rem 0.5rem;
                border-radius: var(--radius-sm);
                font-family: monospace;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>